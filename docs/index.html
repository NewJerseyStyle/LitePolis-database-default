

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LitePolis database default &mdash; LitePolis database default  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API references" href="apis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            LitePolis database default
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apis.html">API references</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">LitePolis database default</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">LitePolis database default</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="litepolis-database-default">
<h1>LitePolis database default<a class="headerlink" href="#litepolis-database-default" title="Link to this heading"></a></h1>
<p>This module is designed to be compatible with the original <a class="reference external" href="https://pol.is">polis</a> platform.</p>
<p>To integrate this module into your LitePolis middleware or FastAPI-based APIs, import the necessary components. Additionally, ensure that the system administrator configures the <code class="docutils literal notranslate"><span class="pre">litepolis_database_default</span></code> section within their <code class="docutils literal notranslate"><span class="pre">~/litepolis/litepolis.config</span></code> file.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apis.html">API references</a></li>
</ul>
</div>
<section id="databaseactor">
<h2>DatabaseActor<a class="headerlink" href="#databaseactor" title="Link to this heading"></a></h2>
<p>DatabaseActor class for LitePolis.</p>
<p>This class serves as the central point of interaction between the LitePolis system
and the database module. It aggregates operations from various manager classes,
such as UserManager, ConversationManager, CommentManager, VoteManager, and ReportManager,
providing a unified interface for database interactions.</p>
</section>
<section id="users-table">
<h2>Users Table<a class="headerlink" href="#users-table" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
</tbody>
</table>
<p id="module-litepolis_database_default.Users">This module defines the User model and UserManager class for interacting with the ‘users’ table in the database.</p>
<p>The ‘users’ table stores information about users, including their email, authentication token, and admin status.
It also includes timestamps for creation and modification. The table supports both standard SQL databases and StarRocks,
with some specific handling for StarRocks (e.g., unique constraints and primary keys).</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Table Schema</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>INTEGER</p></td>
<td><p>Unique identifier for the user.</p></td>
</tr>
<tr class="row-odd"><td><p>email</p></td>
<td><p>VARCHAR</p></td>
<td><p>User’s email address. Must be unique.</p></td>
</tr>
<tr class="row-even"><td><p>auth_token</p></td>
<td><p>VARCHAR</p></td>
<td><p>Authentication token for the user.</p></td>
</tr>
<tr class="row-odd"><td><p>is_admin</p></td>
<td><p>BOOLEAN</p></td>
<td><p>Indicates whether the user is an administrator.</p></td>
</tr>
<tr class="row-even"><td><p>created</p></td>
<td><p>DATETIME</p></td>
<td><p>Timestamp indicating when the user was created.</p></td>
</tr>
<tr class="row-odd"><td><p>modified</p></td>
<td><p>DATETIME</p></td>
<td><p>Timestamp indicating when the user was last modified.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Relationships</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<tbody>
<tr class="row-odd"><td><p>Comment</p></td>
<td><p>One-to-many.</p></td>
</tr>
<tr class="row-even"><td><p>Vote</p></td>
<td><p>One-to-many.</p></td>
</tr>
<tr class="row-odd"><td><p>Conversation</p></td>
<td><p>One-to-many.</p></td>
</tr>
</tbody>
</table>
<p>The UserManager class provides static methods for interacting with the ‘users’ table, including CRUD operations,
searching, listing with pagination, and counting.</p>
<p>To use the methods in this module, import DatabaseActor.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_user</span><span class="p">({</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;test@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auth_token&quot;</span><span class="p">:</span> <span class="s2">&quot;auth_token&quot;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Create a user</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_user</span><span class="p">({</span>
    <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;test@example.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auth_token&quot;</span><span class="p">:</span> <span class="s2">&quot;auth_token&quot;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Read a user by ID</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">read_user</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Read a user by email</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">read_user_by_email</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span><span class="p">)</span>

<span class="c1"># List users with pagination</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_users</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Update a user</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">update_user</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;new_email@example.com&quot;</span><span class="p">})</span>

<span class="c1"># Delete a user</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">delete_user</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Search users by email</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">search_users_by_email</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;example.com&quot;</span><span class="p">)</span>

<span class="c1"># List users by admin status</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_users_by_admin_status</span><span class="p">(</span><span class="n">is_admin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># List users created in a date range</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_users_created_in_date_range</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>

<span class="c1"># Count users</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">count_users</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="module-litepolis_database_default.Comments">
<span id="comments-table"></span><h2>Comments Table<a class="headerlink" href="#module-litepolis_database_default.Comments" title="Link to this heading"></a></h2>
<p>This module defines the database schema for comments, including the <cite>Comment</cite> model
and the <cite>CommentManager</cite> class for managing comment data.</p>
<p>The <cite>Comment</cite> model represents the <cite>comments</cite> table and includes fields for
the comment’s content (<cite>text_field</cite>), timestamps (<cite>created</cite>, <cite>modified</cite>),
and foreign keys linking to the user (<cite>user_id</cite>), conversation (<cite>conversation_id</cite>),
and parent comment (<cite>parent_comment_id</cite>). It also defines relationships to
related <cite>User</cite>, <cite>Conversation</cite>, <cite>Vote</cite>, and other <cite>Comment</cite> instances (for replies).</p>
<p>The <cite>CommentManager</cite> class provides static methods for common database operations
on comments, such as creating, reading, updating, deleting, listing by various
criteria (conversation, user, date range), searching, and counting.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Table Schemas</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Table Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>users</p></td>
<td><p>Stores user information (id, email, auth_token, etc.).</p></td>
</tr>
<tr class="row-odd"><td><p>conversations</p></td>
<td><p>Stores conversation information (id, title, etc.).</p></td>
</tr>
<tr class="row-even"><td><p>comments</p></td>
<td><p>Stores comment information (id, text_field, user_id, conversation_id, parent_comment_id, created, modified).</p></td>
</tr>
<tr class="row-odd"><td><p>votes</p></td>
<td><p>Stores vote information (id, user_id, comment_id, value).</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Comments Table Details</span><a class="headerlink" href="#id4" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id (int)</p></td>
<td><p>Primary key for the comment.</p></td>
</tr>
<tr class="row-odd"><td><p>text_field (str)</p></td>
<td><p>The content of the comment.</p></td>
</tr>
<tr class="row-even"><td><p>user_id (int, optional)</p></td>
<td><p>Foreign key referencing the user who created the comment.</p></td>
</tr>
<tr class="row-odd"><td><p>conversation_id (int, optional)</p></td>
<td><p>Foreign key referencing the conversation the comment belongs to.</p></td>
</tr>
<tr class="row-even"><td><p>parent_comment_id (int, optional)</p></td>
<td><p>Foreign key referencing the parent comment (for replies).</p></td>
</tr>
<tr class="row-odd"><td><p>created (datetime)</p></td>
<td><p>Timestamp of when the comment was created.</p></td>
</tr>
<tr class="row-even"><td><p>modified (datetime)</p></td>
<td><p>Timestamp of when the comment was last modified.</p></td>
</tr>
<tr class="row-odd"><td><p>user (Relationship)</p></td>
<td><p>Relationship to the User who created the comment.</p></td>
</tr>
<tr class="row-even"><td><p>conversation (Relationship)</p></td>
<td><p>Relationship to the Conversation the comment belongs to.</p></td>
</tr>
<tr class="row-odd"><td><p>votes (Relationship)</p></td>
<td><p>Relationship to the Votes associated with this comment.</p></td>
</tr>
<tr class="row-even"><td><p>replies (Relationship)</p></td>
<td><p>Relationship to other Comments that are replies to this comment.</p></td>
</tr>
<tr class="row-odd"><td><p>parent_comment (Relationship)</p></td>
<td><p>Relationship to the parent Comment if this is a reply.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Classes</span><a class="headerlink" href="#id5" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Class Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Comment</p></td>
<td><p>SQLModel class representing the <cite>comments</cite> table.</p></td>
</tr>
<tr class="row-odd"><td><p>CommentManager</p></td>
<td><p>Provides static methods for managing comments (create, read, update, delete, list, search, count).</p></td>
</tr>
</tbody>
</table>
<p>To use the methods in this module, import <cite>DatabaseActor</cite> from
<cite>litepolis_database_default</cite>. For example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>

<span class="n">comment</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_comment</span><span class="p">({</span>
    <span class="s2">&quot;text_field&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a test comment.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Create a comment</span>
<span class="n">comment</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_comment</span><span class="p">({</span>
    <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;This is a comment.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;conversation_id&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>

<span class="c1"># Read a comment by ID</span>
<span class="n">comment</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">read_comment</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># List comments by conversation ID</span>
<span class="n">comments</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_comments_by_conversation_id</span><span class="p">(</span><span class="n">conversation_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="s2">&quot;created&quot;</span><span class="p">,</span> <span class="n">order_direction</span><span class="o">=</span><span class="s2">&quot;asc&quot;</span><span class="p">)</span>

<span class="c1"># Update a comment</span>
<span class="n">updated_comment</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">update_comment</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Updated comment text.&quot;</span><span class="p">})</span>

<span class="c1"># Delete a comment</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">delete_comment</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Search comments</span>
<span class="n">comments</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">search_comments</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;search term&quot;</span><span class="p">)</span>

<span class="c1"># List comments by user ID</span>
<span class="n">comments</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_comments_by_user_id</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># List comments created in a date range</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">comments</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_comments_created_in_date_range</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>

<span class="c1"># Count comments in a conversation</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">count_comments_in_conversation</span><span class="p">(</span><span class="n">conversation_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Get a comment with its replies</span>
<span class="n">comment</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">get_comment_with_replies</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="module-litepolis_database_default.Conversations">
<span id="conversations-table"></span><h2>Conversations Table<a class="headerlink" href="#module-litepolis_database_default.Conversations" title="Link to this heading"></a></h2>
<p>This module defines the Conversation model and ConversationManager class for interacting with the ‘conversations’ table in the database.</p>
<p>The ‘conversations’ table stores information about conversations, including their title, description, archive status, and the user who created them.
It also includes timestamps for creation and modification.</p>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Table Schema</span><a class="headerlink" href="#id6" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>INTEGER</p></td>
<td><p>Unique identifier for the conversation.</p></td>
</tr>
<tr class="row-odd"><td><p>user_id</p></td>
<td><p>INTEGER</p></td>
<td><p>Foreign key referencing the user who created the conversation.</p></td>
</tr>
<tr class="row-even"><td><p>title</p></td>
<td><p>VARCHAR</p></td>
<td><p>Title of the conversation.</p></td>
</tr>
<tr class="row-odd"><td><p>description</p></td>
<td><p>VARCHAR</p></td>
<td><p>Description of the conversation.</p></td>
</tr>
<tr class="row-even"><td><p>is_archived</p></td>
<td><p>BOOLEAN</p></td>
<td><p>Indicates whether the conversation is archived.</p></td>
</tr>
<tr class="row-odd"><td><p>created</p></td>
<td><p>DATETIME</p></td>
<td><p>Timestamp indicating when the conversation was created.</p></td>
</tr>
<tr class="row-even"><td><p>modified</p></td>
<td><p>DATETIME</p></td>
<td><p>Timestamp indicating when the conversation was last modified.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text">Relationships</span><a class="headerlink" href="#id7" title="Link to this table"></a></caption>
<tbody>
<tr class="row-odd"><td><p>comments</p></td>
<td><p>One-to-many relationship with the Comment model.</p></td>
</tr>
<tr class="row-even"><td><p>user</p></td>
<td><p>Many-to-one relationship with the User model.</p></td>
</tr>
</tbody>
</table>
<p>The ConversationManager class provides static methods for performing CRUD (Create, Read, Update, Delete) operations
on the ‘conversations’ table, as well as methods for listing, searching, counting, and archiving conversations.</p>
<p>To use the methods in this module, import DatabaseActor.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>

<span class="n">conversation</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_conversation</span><span class="p">({</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;New Conversation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A new conversation about a topic.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>

<span class="c1"># Create a conversation</span>
<span class="n">conversation</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_conversation</span><span class="p">({</span>
    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;New Conversation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;A new conversation about a topic.&quot;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Read a conversation by ID</span>
<span class="n">conversation</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">read_conversation</span><span class="p">(</span><span class="n">conversation_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># List conversations with pagination and ordering</span>
<span class="n">conversations</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_conversations</span><span class="p">(</span><span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">order_direction</span><span class="o">=</span><span class="s2">&quot;asc&quot;</span><span class="p">)</span>

<span class="c1"># Update a conversation</span>
<span class="n">updated_conversation</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">update_conversation</span><span class="p">(</span><span class="n">conversation_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Updated Title&quot;</span><span class="p">})</span>

<span class="c1"># Delete a conversation</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">delete_conversation</span><span class="p">(</span><span class="n">conversation_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Search conversations</span>
<span class="n">conversations</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">search_conversations</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;search term&quot;</span><span class="p">)</span>

<span class="c1"># List conversations by archived status</span>
<span class="n">conversations</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_conversations_by_archived_status</span><span class="p">(</span><span class="n">is_archived</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># List conversations created in a date range</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">conversations</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_conversations_created_in_date_range</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>

<span class="c1"># Count conversations</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">count_conversations</span><span class="p">()</span>

<span class="c1"># Archive a conversation</span>
<span class="n">archived_conversation</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">archive_conversation</span><span class="p">(</span><span class="n">conversation_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="module-litepolis_database_default.Vote">
<span id="votes-table"></span><h2>Votes Table<a class="headerlink" href="#module-litepolis_database_default.Vote" title="Link to this heading"></a></h2>
<p>This module defines the database schema for votes, including the <cite>Vote</cite> model
and <cite>VoteManager</cite> class for managing votes.</p>
<p>The database schema includes tables for users, comments, and votes,
with relationships defined between them. The <cite>Vote</cite> table stores information
about individual votes, including the voter, target comment, and vote value.</p>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">Table Schemas</span><a class="headerlink" href="#id8" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Table Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>users</p></td>
<td><p>Stores user information (id, email, auth_token, etc.).</p></td>
</tr>
<tr class="row-odd"><td><p>comments</p></td>
<td><p>Stores comment information (id, text, user_id, conversation_id, parent_comment_id, created, modified).</p></td>
</tr>
<tr class="row-even"><td><p>votes</p></td>
<td><p>Stores vote information (id, user_id, comment_id, value, created, modified).</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">Votes Table Details</span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id (int)</p></td>
<td><p>Primary key for the vote.</p></td>
</tr>
<tr class="row-odd"><td><p>user_id (int, optional)</p></td>
<td><p>Foreign key referencing the user who created the vote.</p></td>
</tr>
<tr class="row-even"><td><p>comment_id (int, optional)</p></td>
<td><p>Foreign key referencing the comment being voted on.</p></td>
</tr>
<tr class="row-odd"><td><p>value (int)</p></td>
<td><p>The value of the vote.</p></td>
</tr>
<tr class="row-even"><td><p>created (datetime)</p></td>
<td><p>Timestamp of when the vote was created.</p></td>
</tr>
<tr class="row-odd"><td><p>modified (datetime)</p></td>
<td><p>Timestamp of when the vote was last modified.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id10">
<caption><span class="caption-text">Classes</span><a class="headerlink" href="#id10" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Class Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Vote</p></td>
<td><p>SQLModel class representing the <cite>votes</cite> table.</p></td>
</tr>
<tr class="row-odd"><td><p>VoteManager</p></td>
<td><p>Provides static methods for managing votes.</p></td>
</tr>
</tbody>
</table>
<p>To use the methods in this module, import <cite>DatabaseActor</cite> from
<cite>litepolis_database_default</cite>. For example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>

<span class="n">vote</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_vote</span><span class="p">({</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment_id&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new vote</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>

<span class="n">vote</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">create_vote</span><span class="p">({</span>
    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;comment_id&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">})</span>

<span class="c1"># Read a vote by ID</span>
<span class="n">vote</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">read_vote</span><span class="p">(</span><span class="n">vote_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Get a vote by user and comment</span>
<span class="n">vote</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">get_vote_by_user_comment</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># List votes by comment ID with pagination and ordering</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_votes_by_comment_id</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="s2">&quot;created&quot;</span><span class="p">,</span> <span class="n">order_direction</span><span class="o">=</span><span class="s2">&quot;asc&quot;</span><span class="p">)</span>

<span class="c1"># Update a vote</span>
<span class="n">updated_vote</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">update_vote</span><span class="p">(</span><span class="n">vote_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>

<span class="c1"># Delete a vote</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">delete_vote</span><span class="p">(</span><span class="n">vote_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># List votes by user ID with pagination</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_votes_by_user_id</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># List votes created in a date range</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">litepolis_database_default</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatabaseActor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">list_votes_created_in_date_range</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>

<span class="c1"># Count votes for a comment</span>
<span class="n">count</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">count_votes_for_comment</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Get vote value distribution for a comment</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">DatabaseActor</span><span class="o">.</span><span class="n">get_vote_value_distribution_for_comment</span><span class="p">(</span><span class="n">comment_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="apis.html" class="btn btn-neutral float-right" title="API references" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NewJerseyStyle.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>